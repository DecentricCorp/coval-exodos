/*
exodos - v0.0.0 - 2017-01-05
Transition tools to assist in exodos from legacy chain
Lovingly coded by Shannon Code  - http://cov.al 
*/
function init(){footerCallbackCnt=0,table=$("#example-table").DataTable({ajax:"/utils/data/rich.json",deferRender:!1,columns:[{className:"details-control",orderable:!0,data:"txs",defaultContent:""},{data:"address"},{data:"balance",className:"sum",render:$.fn.dataTable.render.number(",",".",7,"")},{data:"lastActivity"},{data:"txCount"}],footerCallback:function(row,data,start,end,display){verbose&&console.log("in footerCallback");var api=this.api();api.columns(".sum",{search:"applied",page:"all"}).every(function(){var sum=api.cells(null,this.index(),{search:"applied",page:"all"}).render("display").reduce(function(a,b){var x=parseFloat(a)||0,y=parseFloat(b)||0;return x+y},0);verbose&&console.log(this.index()+" "+sum),$(this.footer()).html(sum),0===footerCallbackCnt?footerCallbackCnt++:footerCallbackCnt=0})}}),$.fn.dataTable.ext.search.push(function(settings,data,dataIndex){var min=parseInt($("#min").val(),10),max=parseInt($("#max").val(),10),age=parseFloat(data[4])||0;return isNaN(min)&&isNaN(max)||isNaN(min)&&max>=age||age>=min&&isNaN(max)||age>=min&&max>=age?!0:!1}),loginCheck()}function loginCheck(){me.data.identity(function(identity){var loggedIn=""!=identity.email&&""!=identity.name;verbose&&console.log("Logged in",loggedIn,identity),loggedIn?($(".loginStatus").text(identity.name.replace("::"," ")+" Logout"),enableKeysView()):disableKeysView()})}function enableKeysView(){$("body").off("click.keys"),$("body").on("click.keys",".viewKeys",function(){renderKeysTemplate()})}function disableKeysView(){$("body").off("click.keys"),$("body").on("click.keys",".viewKeys",function(){popLoginModalSelection()})}function showExplorer(){jQuery.get("/explorer",function(resp){templates[name]=Handlebars.compile(resp),display_Pagetemplate(name,function(){init()})})}function display_Pagetemplate(tmpl,cb){if(console.log("display"),void 0!==templates[tmpl]){var template=templates[tmpl],html=template();return $(".pageContent").html(html),cb()}}function getRow(address,cb){var filtered=table.rows()[0].filter(function(a){var data=table.rows(a).data()[0].address;return data==address});return cb(table.rows(filtered[0]).data()[0])}function signBalance(key,cb){var hd=bitcore.HDPrivateKey(key),address=hd.privateKey.toAddress().toString();getRow(address,function(details){var msg=details.address+details.balance+details.lastActivity,payload=generatePayload(msg,key);return payload.coval.swap=details,payload=deserializePayload(payload),cb(payload)})}function deserializePayload(payload){return"string"==typeof payload&&(payload=JSON.parse(payload)),payload.verify=getVerifyFunction(payload),payload.serialize=function(){return JSON.stringify(payload)},payload}function getVerifyFunction(payload){var cb=function(result){return result};return function(){return newtables.privkey.verifyMessage(payload.coval.toSign,payload.coval.covalAddress,payload.coval.signature,cb)}}var table;$(document).ready(function(){init(),verbose=!1}),$("#min, #max").keyup(function(){table.draw()}),$("body").on("keyup",".customSearch",function(){$("input[type='search']").val($(".customSearch").val()),$("input[type='search']").trigger("keyup")}),$(".dataTables_filter").hide(),$(function(){$("#nav li a").click(function(){$("#nav li").removeClass(),$($(this).attr("href")).addClass("active")})}),$("body").on("click",".loginStatus",function(){popLoginModalSelection()}),$("body").on("click","#example-table tbody",function(){var tr=$(this).closest("tr"),row=table.row(tr);row.child.isShown()?(row.child.hide(),tr.removeClass("shown")):(row.child(format(row.data())).show(),tr.addClass("shown"))});var templates={};